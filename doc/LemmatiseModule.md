# Topic Mapping Pipeline - 2020 [![CC BY-NC 4.0][cc-by-nc-shield]][cc-by-nc]
# Lemmatise Module

The Lemmatise module is the second module of the Topic Mapping pipeline. It *cleans* the corpus and produce lemmatised
text data for the topic modelling process. This data is saved in a ***Lemma JSON file***.

The Lemmatise module is contained in the `P2_Lemmatise` package.

## Specifications

The Lemmatise module entry in the project file should have the following structure:
```json5
{...
  "lemmatise": {
    "corpus": "path",
    "textFields": ["key", ...],
    "docFields": ["key", ...],
    "stopWords": ["word", ...],
    "minLemmas": 1,
    "removeLowCounts": 0,
    "output": "path"
  }
...}
``` 

Where:
- `corpus` is the path to the corpus (generated by an [input module](InputModule.md));
- `output` is the path to the output lemma JSON file;
- `textFields` lists, in the `docData` object of each document, which attributes will constitute the text (i.e. to be
lemmatised);
- `docFields` lists, in the `docData` object of each document, which attributes should be kept after the lemmatising
process (e.g. to be analysed later on, or to be printed on an interface, etc.), this list is optional and is set to
empty (`[]`) by default;
- `stopWords` lists the labels that should be removed from the documents (after lemmatisation), e.g. if these labels are
too generic, this list is optional and is set to empty (`[]`) by default;
- `minLemma` is the minimum number of lemmas a document should have to be kept for the modelling process, i.e. documents
with too few words are removed, this number is optional and is set to `1` by default;
- PROTOTYPE: `removeLowCounts` is the mininum number of times a lemma should be counted in the total vocabulary, if the 
count is below this value, the lemma is ignored, this number is optional and is set to `0` by default, using this 
parameter can remove a large amount of information.

## Output

The Lemmatise module generates a lemma JSON file which follow a similar structure to the corpus file:
```json5
{
  "metadata":{
    "nDocsRemoved": 5,
    "totalDocs": 1000,
    "stopWords":"",
    "nLemmasRemoved": 0
  },
  "lemmas":[
    {
      "docId": "0",
      "docIndex": 0,
      "lemmas": "lemma1 lemma2 ...",
      "numLemmas": 100,
      "docData": {"key": "value1", ...}
    },{
      "docId": "1",
      "docIndex": 1,
      "removed": true,
      "removeReason":"Too short",
      "lemmas": "lemma4 lemma5",
      "numLemmas": 2,
      "docData": {"key": "value2", ...}
    }, ...
  ]
}
```

In addition to the number of documents, the `metadata` now also contains:
- the number of documents removed for being too small (`nDocsRemoved`);
- the list of stop words (`stopWords`);
- the number of lemmas removed from the vocabulary (`nLemmasRemoved` - only if `removeLowCounts` was set in the
specifications).

Then the file has a `lemmas` list, with one object per document with the following information:
- `docId` the document id;
- `docIndex` the document index;
- `lemmas` the string containing the lemmatised text for that document;
- `numLemmas` the number of lemmas in that document;
- `docData` the document data that was kept with `docFields`;
- if the document was found too short (as per the setting of `minLemma` in the specifications), the documents also has:
    - `removed` a boolean set to true to notify the following modules that this document should not be counted;
    - `removeReason` stating the reason to ignore that document, in the case of the Lemmatise module, that reason would
    be: `"Too short"`.

---

[< Previous](InputModule.md) | [Index](index.md) | [Next >](ModelModule.md)

---
This work is licensed under a [Creative Commons Attribution 4.0 International
License][cc-by-nc].

[![CC BY-NC 4.0][cc-by-nc-image]][cc-by-nc]

[cc-by-nc]: http://creativecommons.org/licenses/by-nc/4.0/
[cc-by-nc-image]: https://i.creativecommons.org/l/by-nc/4.0/88x31.png
[cc-by-nc-shield]: https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg
